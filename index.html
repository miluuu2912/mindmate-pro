<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Mann Mitra - Your Mental Health Companion</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{--primary:#4f46e5;--primary-dark:#4338ca;--secondary:#ec4899;--secondary-dark:#db2777;--bg-gradient-start:#4f46e5;--bg-gradient-end:#ec4899;--text-primary:#1f2937;--text-secondary:#6b7280;--bg-card:#ffffff;--bg-input:#ffffff;--border-color:#e5e7eb;--shadow:rgba(0,0,0,0.1);--shadow-lg:rgba(0,0,0,0.2)}[data-theme="dark"]{--primary:#818cf8;--primary-dark:#6366f1;--secondary:#f472b6;--secondary-dark:#ec4899;--bg-gradient-start:#1e1b4b;--bg-gradient-end:#831843;--text-primary:#f9fafb;--text-secondary:#d1d5db;--bg-card:#1f2937;--bg-input:#374151;--border-color:#4b5563;--shadow:rgba(0,0,0,0.3);--shadow-lg:rgba(0,0,0,0.5)}*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}body{font-family:Poppins,sans-serif;background:linear-gradient(135deg,var(--bg-gradient-start) 0%,var(--bg-gradient-end) 100%);min-height:100vh;color:var(--text-primary);overflow-x:hidden;transition:all .3s ease}body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 50%,rgba(255,255,255,.1) 0%,transparent 50%),radial-gradient(circle at 80% 80%,rgba(255,255,255,.1) 0%,transparent 50%);pointer-events:none;animation:float 20s ease-in-out infinite}@keyframes float{0%,100%{transform:translate(0,0)}50%{transform:translate(30px,30px)}}.container{max-width:1400px;margin:0 auto;padding:15px;position:relative;z-index:1}.theme-toggle{position:fixed;bottom:20px;right:20px;width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--secondary));border:none;cursor:pointer;box-shadow:0 8px 20px var(--shadow-lg);z-index:1000;display:flex;align-items:center;justify-content:center;font-size:1.5rem;transition:all .3s;touch-action:manipulation}.theme-toggle:active{transform:scale(.95)}.theme-toggle:hover{transform:scale(1.1)}.login-container,.assessment-container{max-width:600px;margin:50px auto;background:var(--bg-card);padding:40px 30px;border-radius:25px;box-shadow:0 25px 70px var(--shadow-lg);animation:fadeInUp .8s ease}@keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.login-header,.assessment-header{text-align:center;margin-bottom:30px}.login-logo{font-size:3rem;margin-bottom:10px}.login-header h1,.assessment-header h1{font-size:1.8rem;background:linear-gradient(135deg,var(--primary),var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:800;margin-bottom:8px}.login-header p,.assessment-header p{color:var(--text-secondary);font-size:1rem;line-height:1.6}.assessment-progress{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding:15px;background:var(--bg-input);border-radius:15px}.progress-bar{flex:1;height:8px;background:var(--border-color);border-radius:10px;margin:0 15px;overflow:hidden}.progress-fill{height:100%;background:linear-gradient(135deg,var(--primary),var(--secondary));border-radius:10px;transition:width .3s ease}.progress-text{font-size:.9rem;font-weight:600;color:var(--text-secondary)}.question-card{background:var(--bg-input);padding:30px;border-radius:20px;margin-bottom:25px;box-shadow:0 4px 12px var(--shadow)}.question-number{font-size:.85rem;font-weight:700;color:var(--primary);margin-bottom:10px;text-transform:uppercase;letter-spacing:1px}.question-text{font-size:1.2rem;font-weight:600;color:var(--text-primary);margin-bottom:20px;line-height:1.6}.question-instruction{font-size:.95rem;color:var(--text-secondary);margin-bottom:25px;padding:15px;background:var(--bg-card);border-radius:12px;border-left:4px solid var(--primary)}.options-container{display:flex;flex-direction:column;gap:12px}.option-btn{background:var(--bg-card);border:3px solid var(--border-color);padding:18px 20px;border-radius:15px;cursor:pointer;transition:all .3s;display:flex;align-items:center;gap:15px;font-size:1rem;font-weight:600;color:var(--text-primary);touch-action:manipulation}.option-btn:hover{border-color:var(--primary);transform:translateX(5px);box-shadow:0 4px 12px rgba(79,70,229,.2)}.option-btn:active{transform:scale(.98)}.option-btn.selected{border-color:var(--primary);background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;box-shadow:0 8px 20px rgba(79,70,229,.4)}.option-number{width:35px;height:35px;border-radius:50%;background:var(--bg-input);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.9rem;flex-shrink:0}.option-btn.selected .option-number{background:rgba(255,255,255,.2);color:#fff}.btn-navigation{display:flex;gap:15px;justify-content:space-between;margin-top:30px}.btn-nav{background:var(--bg-input);color:var(--primary);border:3px solid var(--primary);padding:15px 30px;border-radius:15px;cursor:pointer;font-weight:700;font-size:1rem;transition:all .3s;touch-action:manipulation;flex:1}.btn-nav:hover{background:var(--primary);color:#fff;transform:translateY(-2px)}.btn-nav:active{transform:scale(.98)}.btn-nav:disabled{opacity:.5;cursor:not-allowed;transform:none}.btn-nav.primary{background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;border:none}.form-group{margin-bottom:20px}.form-label{display:block;color:var(--primary);font-weight:600;margin-bottom:8px;font-size:.95rem}.form-input{width:100%;padding:14px 18px;border:3px solid var(--border-color);border-radius:12px;font-family:Poppins,sans-serif;font-size:1rem;transition:all .3s;background:var(--bg-input);color:var(--text-primary)}.form-input:focus{outline:0;border-color:var(--primary);box-shadow:0 0 15px rgba(79,70,229,.2)}.form-input::placeholder{color:var(--text-secondary)}.btn-login{width:100%;background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;border:none;padding:16px;font-size:1.1rem;font-weight:700;border-radius:15px;cursor:pointer;box-shadow:0 10px 30px rgba(79,70,229,.4);transition:all .3s;margin-top:10px;touch-action:manipulation}.btn-login:active{transform:scale(.98)}.navbar{background:var(--bg-card);padding:15px 20px;border-radius:15px;display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;box-shadow:0 10px 30px var(--shadow);backdrop-filter:blur(10px);flex-wrap:wrap;gap:10px}.nav-brand{display:flex;align-items:center;gap:10px}.logo{font-size:2rem;animation:rotate 3s ease-in-out infinite}@keyframes rotate{0%,100%{transform:rotate(0deg)}50%{transform:rotate(10deg)}}.nav-brand h1{font-size:1.3rem;background:linear-gradient(135deg,var(--primary),var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:800}.nav-menu{display:flex;gap:10px;align-items:center;flex-wrap:wrap}.nav-link{text-decoration:none;color:var(--text-secondary);font-weight:600;transition:all .3s;padding:8px 12px;border-radius:8px;cursor:pointer;font-size:.9rem;touch-action:manipulation}.nav-link:active{transform:scale(.95)}.nav-link:hover{color:var(--primary);background:rgba(79,70,229,.1)}.nav-link.active{color:var(--primary);background:rgba(79,70,229,.1)}.btn-logout{background:linear-gradient(135deg,var(--secondary),var(--secondary-dark));color:#fff;border:none;padding:8px 15px;border-radius:8px;cursor:pointer;font-weight:600;transition:all .3s;font-size:.9rem;touch-action:manipulation}.btn-logout:active{transform:scale(.95)}.crisis-banner{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;padding:15px 20px;border-radius:12px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 8px 20px rgba(239,68,68,.4);flex-wrap:wrap;gap:10px}.crisis-content{display:flex;gap:15px;align-items:center;flex:1;flex-wrap:wrap}.crisis-content a{color:#fff;font-weight:700;text-decoration:none;padding:6px 12px;background:rgba(255,255,255,.2);border-radius:6px;transition:all .3s;font-size:.9rem;touch-action:manipulation}.crisis-content a:active{transform:scale(.95)}.crisis-banner button{background:rgba(255,255,255,.2);border:none;color:#fff;font-size:1.3rem;cursor:pointer;padding:6px 10px;border-radius:6px;touch-action:manipulation}.hero{background:var(--bg-card);padding:40px 25px;border-radius:25px;text-align:center;box-shadow:0 20px 50px var(--shadow-lg);margin-bottom:25px}.greeting-section{margin-bottom:30px}.greeting-time{font-size:1.1rem;color:var(--text-secondary);margin-bottom:8px}.greeting-icon{font-size:2.5rem;margin-bottom:12px}.streak-card{display:inline-flex;align-items:center;gap:15px;background:linear-gradient(135deg,var(--primary),var(--secondary));padding:20px 35px;border-radius:50px;color:#fff;margin-bottom:25px;box-shadow:0 12px 30px rgba(79,70,229,.5)}.streak-icon{font-size:2.5rem;animation:flame 1.5s ease-in-out infinite}@keyframes flame{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}.streak-number{font-size:2.2rem;font-weight:800}.streak-label{font-size:.9rem;font-weight:600}.hero h2{font-size:2rem;color:var(--primary);margin-bottom:12px;font-weight:800}.hero-subtitle{font-size:1.1rem;color:var(--text-secondary);margin-bottom:35px;font-weight:500}.mood-selector{display:grid;grid-template-columns:repeat(auto-fit,minmax(90px,1fr));gap:12px;justify-content:center;margin-bottom:35px;max-width:500px;margin-left:auto;margin-right:auto}.mood-btn{background:var(--bg-card);border:3px solid var(--border-color);padding:18px 10px;border-radius:18px;cursor:pointer;transition:all .3s;display:flex;flex-direction:column;align-items:center;gap:8px;font-size:2rem;touch-action:manipulation;box-shadow:0 4px 12px var(--shadow)}.mood-btn:active{transform:scale(.95)}.mood-btn:hover{border-color:var(--primary);box-shadow:0 8px 20px rgba(79,70,229,.3)}.mood-btn span{font-size:.85rem;font-weight:700;color:var(--primary)}.btn-primary{background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;border:none;padding:18px 45px;font-size:1.1rem;font-weight:700;border-radius:50px;cursor:pointer;box-shadow:0 12px 30px rgba(79,70,229,.5);transition:all .3s;touch-action:manipulation}.btn-primary:active{transform:scale(.98)}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px;margin-top:35px}.stat-card{background:var(--bg-card);padding:25px 20px;border-radius:18px;display:flex;align-items:center;gap:15px;transition:all .3s;cursor:pointer;touch-action:manipulation;box-shadow:0 4px 12px var(--shadow)}.stat-card:active{transform:scale(.98)}.stat-icon{font-size:2.5rem}.stat-value{font-size:2.2rem;font-weight:800;color:var(--primary)}.stat-label{font-size:.9rem;color:var(--text-secondary);font-weight:600}.calendar-section{background:var(--bg-card);border-radius:25px;padding:30px 20px;box-shadow:0 20px 50px var(--shadow-lg);margin-bottom:25px}.calendar-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;flex-wrap:wrap;gap:15px}.calendar-header h2{font-size:1.8rem;color:var(--primary);font-weight:800}.calendar-nav{display:flex;gap:10px;align-items:center}.calendar-nav button{background:var(--bg-input);border:none;padding:8px 15px;border-radius:10px;cursor:pointer;font-weight:600;color:var(--primary);transition:all .3s;touch-action:manipulation}.calendar-nav button:active{transform:scale(.95)}.calendar-month{font-size:1.1rem;font-weight:700;color:var(--text-primary);min-width:150px;text-align:center}.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:8px}.calendar-day-header{text-align:center;font-weight:700;color:var(--text-secondary);font-size:.85rem;padding:10px 5px}.calendar-day{aspect-ratio:1;display:flex;flex-direction:column;align-items:center;justify-content:center;background:var(--bg-input);border-radius:12px;cursor:pointer;transition:all .3s;position:relative;padding:8px;touch-action:manipulation}.calendar-day:hover{transform:scale(1.05);box-shadow:0 4px 12px var(--shadow)}.calendar-day.other-month{opacity:.3}.calendar-day.today{border:3px solid var(--primary);font-weight:800}.calendar-day-number{font-size:.9rem;font-weight:600;color:var(--text-primary);margin-bottom:4px}.calendar-day-mood{font-size:1.5rem;line-height:1}.calendar-day.empty{background:transparent;cursor:default}.calendar-day.empty:hover{transform:none;box-shadow:none}.mood-legend{display:flex;justify-content:center;gap:15px;margin-top:20px;flex-wrap:wrap}.mood-legend-item{display:flex;align-items:center;gap:8px;font-size:.85rem;color:var(--text-secondary)}.mood-legend-emoji{font-size:1.3rem}.chat-section{background:var(--bg-card);border-radius:25px;padding:20px 15px;box-shadow:0 20px 50px var(--shadow-lg);margin-bottom:25px}.chat-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:15px;border-bottom:3px solid var(--border-color);margin-bottom:15px;flex-wrap:wrap;gap:10px}.chat-header button{background:var(--bg-input);border:none;font-size:1rem;cursor:pointer;padding:10px 18px;border-radius:10px;transition:all .3s;font-weight:600;color:var(--primary);touch-action:manipulation}.chat-header button:active{transform:scale(.95)}.chat-status{display:flex;align-items:center;gap:8px;color:#10b981;font-weight:700;font-size:.95rem}.status-dot{width:10px;height:10px;background:#10b981;border-radius:50%;animation:pulse 2s infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}.chat-container{height:calc(100vh - 350px);min-height:400px;max-height:550px;overflow-y:auto;padding:15px;background:var(--bg-input);border-radius:18px;margin-bottom:15px;scroll-behavior:smooth;-webkit-overflow-scrolling:touch}.chat-container::-webkit-scrollbar{width:6px}.chat-container::-webkit-scrollbar-track{background:var(--border-color);border-radius:10px}.chat-container::-webkit-scrollbar-thumb{background:linear-gradient(135deg,var(--primary),var(--secondary));border-radius:10px}.message{margin-bottom:18px;display:flex;gap:10px;animation:slideIn .5s ease}@keyframes slideIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}.user-message{justify-content:flex-end}.message-avatar{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;background:linear-gradient(135deg,var(--primary),var(--secondary));flex-shrink:0;box-shadow:0 4px 12px rgba(79,70,229,.4)}.message-content{max-width:80%;padding:14px 18px;border-radius:18px;line-height:1.6;font-size:.95rem;font-weight:500;white-space:pre-wrap;word-wrap:break-word}.ai-message .message-content{background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;border-bottom-left-radius:6px;box-shadow:0 6px 15px rgba(79,70,229,.3)}.user-message .message-content{background:var(--bg-card);color:var(--text-primary);border-bottom-right-radius:6px;box-shadow:0 6px 15px var(--shadow)}.chat-input-area{background:var(--bg-input);border-radius:18px;padding:15px}.input-wrapper{display:flex;gap:8px;align-items:flex-end;margin-bottom:0}#messageInput{flex:1;border:3px solid var(--border-color);border-radius:15px;padding:12px 15px;font-family:Poppins,sans-serif;resize:none;min-height:50px;max-height:120px;transition:all .3s;font-size:.95rem;background:var(--bg-card);color:var(--text-primary)}#messageInput:focus{outline:0;border-color:var(--primary);box-shadow:0 0 15px rgba(79,70,229,.2)}.btn-voice{background:linear-gradient(135deg,var(--secondary),var(--secondary-dark));border:none;width:50px;height:50px;border-radius:50%;cursor:pointer;transition:all .3s;font-size:1.3rem;box-shadow:0 6px 15px rgba(236,72,153,.4);flex-shrink:0;touch-action:manipulation}.btn-voice:active{transform:scale(.95)}.btn-voice.listening{animation:pulseVoice 1s infinite}@keyframes pulseVoice{0%,100%{transform:scale(1)}50%{transform:scale(1.15)}}.btn-send{background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;border:none;padding:12px 25px;border-radius:15px;font-weight:700;cursor:pointer;font-size:1rem;transition:all .3s;box-shadow:0 6px 15px rgba(79,70,229,.4);flex-shrink:0;touch-action:manipulation}.btn-send:active{transform:scale(.95)}.insights-section,.resources-section{background:var(--bg-card);border-radius:25px;padding:30px 20px;box-shadow:0 20px 50px var(--shadow-lg);margin-bottom:25px}.insights-section h2,.resources-section h2{text-align:center;font-size:1.8rem;color:var(--primary);margin-bottom:30px;font-weight:800}.insights-grid,.resources-grid{display:grid;grid-template-columns:1fr;gap:20px}.insight-card,.resource-card{background:var(--bg-input);padding:25px 20px;border-radius:18px;transition:all .3s;cursor:pointer;touch-action:manipulation}.insight-card:active,.resource-card:active{transform:scale(.98)}.insight-card h3,.resource-card h3{color:var(--primary);margin-bottom:18px;font-size:1.3rem;font-weight:700}.cbt-modules{display:flex;flex-direction:column;gap:15px}.module-item{display:flex;align-items:center;gap:15px;background:var(--bg-card);padding:15px;border-radius:15px;transition:all .3s;cursor:pointer;touch-action:manipulation;box-shadow:0 4px 12px var(--shadow)}.module-item:active{transform:scale(.98)}.module-icon{font-size:2rem;flex-shrink:0}.module-item strong{display:block;color:var(--primary);font-size:1.05rem;margin-bottom:4px}.module-item p{font-size:.85rem;color:var(--text-secondary)}.btn-small{background:linear-gradient(135deg,var(--primary),var(--secondary));color:#fff;border:none;padding:8px 18px;border-radius:10px;cursor:pointer;font-weight:700;transition:all .3s;font-size:.85rem;flex-shrink:0;touch-action:manipulation}.btn-small:active{transform:scale(.95)}.badges-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}.badge{text-align:center;padding:15px 10px;background:var(--bg-card);border-radius:15px;filter:grayscale(100%);opacity:.4;transition:all .4s;box-shadow:0 4px 12px var(--shadow)}.badge.unlocked{filter:grayscale(0%);opacity:1;animation:badgeUnlock .6s ease}@keyframes badgeUnlock{0%{transform:scale(0) rotate(-180deg)}100%{transform:scale(1) rotate(0)}}.badge-icon{font-size:2rem;display:block;margin-bottom:6px}.badge-name{font-size:.75rem;color:var(--primary);font-weight:700}.resource-icon{font-size:3rem;display:block;margin-bottom:15px}.resource-card ul{list-style:none;padding:0}.resource-card li{padding:10px 0;border-bottom:2px solid var(--border-color);font-weight:500;font-size:.9rem;color:var(--text-primary)}.btn-secondary{background:var(--bg-card);color:var(--primary);border:3px solid var(--primary);padding:12px 28px;border-radius:12px;cursor:pointer;font-weight:700;margin-top:15px;transition:all .3s;font-size:.95rem;touch-action:manipulation}.btn-secondary:active{transform:scale(.95)}.modal{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}.modal-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);backdrop-filter:blur(5px)}.modal-content{position:relative;background:var(--bg-card);padding:40px 30px;border-radius:25px;text-align:center;max-width:450px;width:100%;box-shadow:0 30px 80px var(--shadow-lg)}.modal-celebration{font-size:4rem;margin-bottom:20px}.modal-content h2{font-size:1.8rem;color:var(--primary);margin-bottom:20px;font-weight:800}.modal-stats{display:flex;gap:30px;justify-content:center;margin:25px 0;flex-wrap:wrap}.modal-stat{display:flex;flex-direction:column;align-items:center}.modal-stat-icon{font-size:2rem;margin-bottom:8px}.modal-stat-value{font-size:2rem;font-weight:800;color:var(--primary)}.modal-stat-label{font-size:.85rem;color:var(--text-secondary);font-weight:600}.hidden{display:none!important}.typing-indicator{display:flex;gap:6px;padding:12px;margin-bottom:12px;justify-content:center}.typing-indicator span{width:8px;height:8px;background:var(--primary);border-radius:50%;animation:typing 1.4s infinite}@keyframes typing{0%,60%,100%{transform:translateY(0)}30%{transform:translateY(-10px)}}.typing-indicator span:nth-child(2){animation-delay:.2s}.typing-indicator span:nth-child(3){animation-delay:.4s}.cbt-modal{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}.cbt-modal-content{position:relative;background:var(--bg-card);padding:35px 25px;border-radius:25px;max-width:600px;width:100%;max-height:85vh;overflow-y:auto;box-shadow:0 30px 80px var(--shadow-lg)}.cbt-modal-content h2{color:var(--primary);font-size:1.6rem;margin-bottom:20px;font-weight:800}.cbt-modal-content p{line-height:1.7;color:var(--text-secondary);margin-bottom:15px;font-size:1rem}.breathing-circle{width:180px;height:180px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--secondary));margin:25px auto;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.3rem;font-weight:700;box-shadow:0 12px 30px rgba(79,70,229,.5)}.breathing-circle.inhale{animation:breatheIn 4s ease-in-out infinite}.breathing-circle.exhale{animation:breatheOut 4s ease-in-out infinite}@keyframes breatheIn{0%,100%{transform:scale(1)}50%{transform:scale(1.3)}}@keyframes breatheOut{0%,100%{transform:scale(1.3)}50%{transform:scale(1)}}.thought-input{width:100%;padding:12px 15px;border:2px solid var(--border-color);border-radius:12px;font-family:Poppins,sans-serif;margin:12px 0;font-size:.95rem;background:var(--bg-input);color:var(--text-primary)}.thought-input:focus{outline:0;border-color:var(--primary)}.goal-list{list-style:none;padding:0;margin-top:15px}.goal-item{background:var(--bg-input);padding:12px 15px;border-radius:12px;margin:8px 0;display:flex;justify-content:space-between;align-items:center;gap:10px;font-size:.9rem;color:var(--text-primary)}.goal-item.completed{opacity:.6;text-decoration:line-through}@media (min-width:768px){.container{padding:20px}.login-container,.assessment-container{margin:100px auto;padding:60px}.login-logo{font-size:4rem}.login-header h1,.assessment-header h1{font-size:2.5rem}.navbar{padding:20px 40px;border-radius:20px}.logo{font-size:2.5rem}.nav-brand h1{font-size:1.8rem}.nav-link,.btn-logout{font-size:1rem;padding:10px 20px}.hero{padding:80px 60px;border-radius:35px}.greeting-icon{font-size:3rem}.hero h2{font-size:3rem}.hero-subtitle{font-size:1.4rem}.mood-selector{grid-template-columns:repeat(5,1fr);gap:20px;max-width:none}.mood-btn{font-size:2.5rem;padding:25px}.btn-primary{padding:22px 60px;font-size:1.3rem}.stats-grid{grid-template-columns:repeat(3,1fr);gap:25px}.stat-icon{font-size:3.5rem}.stat-value{font-size:3rem}.calendar-section{padding:50px;border-radius:35px}.calendar-grid{gap:12px}.calendar-day{padding:12px}.calendar-day-number{font-size:1rem}.calendar-day-mood{font-size:2rem}.chat-section{padding:35px;border-radius:35px}.chat-container{height:550px}.message-avatar{width:45px;height:45px;font-size:1.8rem}.message-content{font-size:1.05rem;padding:18px 24px}.btn-voice{width:60px;height:60px;font-size:1.5rem}.btn-send{padding:15px 35px;font-size:1.1rem}.insights-section,.resources-section{padding:50px;border-radius:35px}.insights-section h2,.resources-section h2{font-size:2.5rem}.insights-grid,.resources-grid{grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:30px}.insight-card,.resource-card{padding:40px;border-radius:25px}.badges-grid{gap:20px}.badge{padding:20px}.badge-icon{font-size:3rem}.modal-content{padding:60px}.modal-celebration{font-size:6rem}.modal-content h2{font-size:2.5rem}.cbt-modal-content{padding:50px}.cbt-modal-content h2{font-size:2rem}.breathing-circle{width:200px;height:200px;font-size:1.5rem}}@media (max-width:480px){.navbar{padding:12px 15px}.nav-brand h1{font-size:1.1rem}.logo{font-size:1.8rem}.nav-menu{width:100%;justify-content:space-between}.hero{padding:30px 20px}.hero h2{font-size:1.6rem}.greeting-icon{font-size:2rem}.streak-card{padding:15px 25px;gap:12px}.streak-icon{font-size:2rem}.streak-number{font-size:1.8rem}.mood-selector{grid-template-columns:repeat(2,1fr);gap:10px}.mood-btn{font-size:1.8rem;padding:15px 8px}.stat-card{padding:20px 15px}.stat-icon{font-size:2rem}.stat-value{font-size:1.8rem}.calendar-day-number{font-size:.8rem}.calendar-day-mood{font-size:1.2rem}.calendar-grid{gap:5px}.chat-container{height:calc(100vh - 380px);min-height:350px}.message-content{max-width:85%;font-size:.9rem}.badges-grid{grid-template-columns:repeat(2,1fr);gap:10px}.login-container,.assessment-container{margin:30px auto;padding:30px 20px}.login-logo{font-size:2.5rem}.login-header h1,.assessment-header h1{font-size:1.5rem}.theme-toggle{width:50px;height:50px;bottom:15px;right:15px;font-size:1.3rem}.question-text{font-size:1.05rem}.option-btn{padding:15px;font-size:.9rem}}
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">üåô</button>

  <div id="loginPage" class="login-container">
    <div class="login-header">
      <div class="login-logo">üßò</div>
      <h1>Welcome to Mann Mitra</h1>
      <p>Your personal mental health companion</p>
    </div>
    <form id="loginForm" onsubmit="handleLogin(event)">
      <div class="form-group">
        <label class="form-label">Your Name</label>
        <input type="text" id="userName" class="form-input" placeholder="Enter your name" required>
      </div>
      <div class="form-group">
        <label class="form-label">Your Age</label>
        <input type="number" id="userAge" class="form-input" placeholder="Enter your age" min="13" max="100" required>
      </div>
      <div class="form-group">
        <label class="form-label">Your Email</label>
        <input type="email" id="userEmail" class="form-input" placeholder="Enter your email" required>
      </div>
      <button type="submit" class="btn-login">Get Started üöÄ</button>
    </form>
  </div>

  <div id="assessmentPage" class="assessment-container hidden">
    <div class="assessment-header">
      <h1>Academic Stress Assessment üìö</h1>
      <p>Please rate how often you have experienced each of these situations during the current academic semester</p>
    </div>
    
    <div class="assessment-progress">
      <span class="progress-text">Question <span id="currentQuestion">1</span> of 5</span>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width:20%"></div>
      </div>
      <span class="progress-text"><span id="progressPercent">20</span>%</span>
    </div>

    <div class="question-card">
      <div class="question-number">Question <span id="questionNum">1</span></div>
      <div class="question-text" id="questionText">I am dissatisfied with my academic performance this semester.</div>
      <div class="question-instruction">Please rate how often you have experienced this situation:</div>
      
      <div class="options-container">
        <button class="option-btn" onclick="selectOption(1)">
          <span class="option-number">1</span>
          <span>Never</span>
        </button>
        <button class="option-btn" onclick="selectOption(2)">
          <span class="option-number">2</span>
          <span>Rarely</span>
        </button>
        <button class="option-btn" onclick="selectOption(3)">
          <span class="option-number">3</span>
          <span>Sometimes</span>
        </button>
        <button class="option-btn" onclick="selectOption(4)">
          <span class="option-number">4</span>
          <span>Often</span>
        </button>
        <button class="option-btn" onclick="selectOption(5)">
          <span class="option-number">5</span>
          <span>Always</span>
        </button>
      </div>
    </div>

    <div class="btn-navigation">
      <button class="btn-nav" id="prevBtn" onclick="previousQuestion()" disabled>‚Üê Previous</button>
      <button class="btn-nav primary" id="nextBtn" onclick="nextQuestion()" disabled>Next ‚Üí</button>
    </div>
  </div>

  <div id="mainApp" class="container hidden">
    <nav class="navbar">
      <div class="nav-brand"><span class="logo">üßò</span><h1>Mann Mitra</h1></div>
      <div class="nav-menu">
        <a class="nav-link active" onclick="showSection('home')">Home</a>
        <a class="nav-link" onclick="showSection('calendar')">Calendar</a>
        <a class="nav-link" onclick="showSection('journal')">Journal</a>
        <a class="nav-link" onclick="showSection('resources')">Resources</a>
        <button class="btn-logout" onclick="handleLogout()">Logout</button>
      </div>
    </nav>

    <div id="crisisBanner" class="crisis-banner hidden">
      <div class="crisis-content">
        <span>üÜò</span>
        <div><strong>Need help?</strong> <a href="tel:988">988</a> | <a href="tel:18005990019">KIRAN</a></div>
      </div>
      <button onclick="closeCrisis()">‚úï</button>
    </div>

    <section id="home" class="hero">
      <div class="greeting-section">
        <div class="greeting-icon" id="greetingIcon">üåÖ</div>
        <div class="greeting-time" id="greetingTime">Good Morning</div>
        <h2 id="greetingName">Welcome, Friend! üëã</h2>
      </div>
      <div class="streak-card">
        <div class="streak-icon">üî•</div>
        <div><span class="streak-number" id="streakCount">0</span><div class="streak-label">Day Streak</div></div>
      </div>
      <p class="hero-subtitle">How are you feeling today?</p>
      <div class="mood-selector">
        <button class="mood-btn" onclick="quickMood('great')">üòä<span>Great</span></button>
        <button class="mood-btn" onclick="quickMood('good')">üôÇ<span>Good</span></button>
        <button class="mood-btn" onclick="quickMood('okay')">üòê<span>Okay</span></button>
        <button class="mood-btn" onclick="quickMood('low')">üòî<span>Low</span></button>
        <button class="mood-btn" onclick="quickMood('struggling')">üò¢<span>Struggling</span></button>
      </div>
      <button class="btn-primary" onclick="startSession()">Start Daily Check-in</button>
      <div class="stats-grid">
        <div class="stat-card"><div class="stat-icon">üìä</div><div><span class="stat-value" id="totalSessions">0</span><div class="stat-label">Sessions</div></div></div>
        <div class="stat-card"><div class="stat-icon">üí™</div><div><span class="stat-value" id="resilienceScore">0</span><div class="stat-label">Resilience</div></div></div>
        <div class="stat-card"><div class="stat-icon">üéØ</div><div><span class="stat-value" id="goalsCompleted">0</span><div class="stat-label">Goals</div></div></div>
      </div>
    </section>

    <section id="calendar" class="calendar-section hidden">
      <div class="calendar-header">
        <h2>Mood Calendar üìÖ</h2>
        <div class="calendar-nav">
          <button onclick="changeMonth(-1)">‚Üê Prev</button>
          <div class="calendar-month" id="calendarMonth">January 2024</div>
          <button onclick="changeMonth(1)">Next ‚Üí</button>
        </div>
      </div>
      <div class="calendar-grid" id="calendarGrid"></div>
      <div class="mood-legend">
        <div class="mood-legend-item"><span class="mood-legend-emoji">üòä</span><span>Great</span></div>
        <div class="mood-legend-item"><span class="mood-legend-emoji">üôÇ</span><span>Good</span></div>
        <div class="mood-legend-item"><span class="mood-legend-emoji">üòê</span><span>Okay</span></div>
        <div class="mood-legend-item"><span class="mood-legend-emoji">üòî</span><span>Low</span></div>
        <div class="mood-legend-item"><span class="mood-legend-emoji">üò¢</span><span>Struggling</span></div>
      </div>
    </section>

    <section id="chatSection" class="chat-section hidden">
      <div class="chat-header">
        <button onclick="endSession()">‚Üê Back</button>
        <div class="chat-status"><span class="status-dot"></span><span>Dost AI</span></div>
        <button onclick="showCrisis()">üÜò Help</button>
      </div>
      <div class="chat-container" id="chatMessages"></div>
      <div class="chat-input-area">
        <div class="typing-indicator hidden" id="typingIndicator"><span></span><span></span><span></span></div>
        <div class="input-wrapper">
          <textarea id="messageInput" placeholder="Apne dil ki baat share karein..."></textarea>
          <button class="btn-voice" id="voiceBtn" onclick="toggleVoice()">üé§</button>
          <button class="btn-send" onclick="sendMessage()">Send</button>
        </div>
      </div>
    </section>

    <section id="journal" class="insights-section hidden">
      <h2>Your Mental Health Journey üìà</h2>
      <div class="insights-grid">
        <div class="insight-card">
          <h3>CBT Skills üßò</h3>
          <div class="cbt-modules">
            <div class="module-item" onclick="startCBT('breathing')">
              <span class="module-icon">üå¨Ô∏è</span>
              <div><strong>Breathing Exercise</strong><p>5 min guided practice</p></div>
              <button class="btn-small">Start</button>
            </div>
            <div class="module-item" onclick="startCBT('reframing')">
              <span class="module-icon">üí≠</span>
              <div><strong>Thought Reframing</strong><p>Challenge negative thoughts</p></div>
              <button class="btn-small">Start</button>
            </div>
            <div class="module-item" onclick="startCBT('goals')">
              <span class="module-icon">üéØ</span>
              <div><strong>Goal Setting</strong><p>Set achievable targets</p></div>
              <button class="btn-small">Start</button>
            </div>
          </div>
        </div>
        <div class="insight-card">
          <h3>Achievements üèÜ</h3>
          <div class="badges-grid">
            <div class="badge locked" data-badge="3day"><span class="badge-icon">üå±</span><span class="badge-name">Seedling</span></div>
            <div class="badge locked" data-badge="7day"><span class="badge-icon">üåø</span><span class="badge-name">Sprout</span></div>
            <div class="badge locked" data-badge="14day"><span class="badge-icon">üå≥</span><span class="badge-name">Tree</span></div>
            <div class="badge locked" data-badge="30day"><span class="badge-icon">‚≠ê</span><span class="badge-name">Star</span></div>
            <div class="badge locked" data-badge="first"><span class="badge-icon">üéâ</span><span class="badge-name">Starter</span></div>
            <div class="badge locked" data-badge="10sessions"><span class="badge-icon">üíé</span><span class="badge-name">Committed</span></div>
          </div>
        </div>
      </div>
    </section>

    <section id="resources" class="resources-section hidden">
      <h2>Professional Resources üè•</h2>
      <div class="resources-grid">
        <div class="resource-card">
          <span class="resource-icon">üìû</span>
          <h3>Crisis Helplines</h3>
          <ul>
            <li><strong>National:</strong> 988</li>
            <li><strong>KIRAN:</strong> 1800-599-0019</li>
            <li><strong>Vandrevala:</strong> 1860-266-2345</li>
            <li><strong>iCall:</strong> 9152987821</li>
          </ul>
        </div>
        <div class="resource-card">
          <span class="resource-icon">üè•</span>
          <h3>Find Therapist</h3>
          <p>Connect with professionals</p>
          <button class="btn-secondary" onclick="window.open('https://www.practo.com/','_blank')">Search Therapists</button>
        </div>
        <div class="resource-card">
          <span class="resource-icon">üìö</span>
          <h3>Self-Help Resources</h3>
          <ul>
            <li>Anxiety & Panic Guide</li>
            <li>Depression Management</li>
            <li>Stress Reduction</li>
            <li>Sleep Hygiene</li>
          </ul>
        </div>
      </div>
    </section>

    <div id="completionModal" class="modal hidden">
      <div class="modal-overlay" onclick="closeModal()"></div>
      <div class="modal-content">
        <div class="modal-celebration">üéâ</div>
        <h2>Amazing Work!</h2>
        <p>You completed today's check-in</p>
        <div class="modal-stats">
          <div class="modal-stat"><span class="modal-stat-icon">üî•</span><span class="modal-stat-value" id="modalStreak">1</span><span class="modal-stat-label">Streak</span></div>
          <div class="modal-stat"><span class="modal-stat-icon">üí™</span><span class="modal-stat-value">+5</span><span class="modal-stat-label">Resilience</span></div>
        </div>
        <button class="btn-primary" onclick="closeModal()">Continue</button>
      </div>
    </div>

    <div id="cbtModal" class="cbt-modal hidden">
      <div class="modal-overlay" onclick="closeCBTModal()"></div>
      <div class="cbt-modal-content" id="cbtContent"></div>
    </div>
  </div>

  <script>
const GROK_API_KEY='xai-YourGrokAPIKeyHere';const GROK_API_URL='https://api.x.ai/v1/chat/completions';let state={streak:0,sessions:0,resilience:0,goals:0,history:[],badges:new Set(),conversationHistory:[],user:null,theme:'light',moodCalendar:{},currentMonth:new Date().getMonth(),currentYear:new Date().getFullYear(),assessmentAnswers:[],currentQuestionIndex:0};const MOOD_EMOJIS={great:'üòä',good:'üôÇ',okay:'üòê',low:'üòî',struggling:'üò¢'};const ASSESSMENT_QUESTIONS=['I am dissatisfied with my academic performance this semester.','I don\'t have enough time to complete all my academic work thoroughly.','My academic workload interferes with adequate sleep.','I receive insufficient guidance from faculty on academic matters.','I have to rush through assignments to meet deadlines.'];const SYSTEM_PROMPT=`You are a friendly and empathetic AI therapist named "Dost" designed to help teenagers with their mental health. You communicate in Hinglish (a mix of Hindi and English) to create a comfortable and relatable environment. Your primary goal is to listen, understand, and offer support and guidance without ever ending the conversation abruptly. You should always encourage the user to share more and explore their feelings.

IMPORTANT RULES:
1. ACKNOWLEDGE AND VALIDATE: Show empathy using phrases like "Mujhe sunke dukh hua", "Main samajh sakta hoon", "Yeh sunke achha laga"
2. ASK FOLLOW-UP QUESTIONS: Always probe deeper with open-ended questions like "Kya aap mujhe aur bata sakte hain?", "Aapko aisa kyun lag raha hai?", "Isse aapko kaisa feel ho raha hai?"
3. OFFER SUPPORT: Use phrases like "Main aapke saath hoon", "Aap akele nahi hain", "Aap bahut strong hain"
4. AVOID DIRECT SOLUTIONS INITIALLY: Focus on understanding feelings first. Only suggest solutions after full understanding.
5. NEVER END CONVERSATION: Always end with open-ended questions like "Aur kuch share karna chahenge?", "Aapke mann mein aur kya chal raha hai?", "Main yahan hoon sunne ke liye"
6. USE NATURAL HINGLISH: Mix Hindi and English naturally, don't be overly formal
7. BE NON-JUDGMENTAL: Accept all feelings and experiences
8. SAFETY: If self-harm mentioned, gently encourage professional help and provide helpline numbers

Remember: You are a supportive friend who is ALWAYS there to listen. Never end the conversation.`;function load(){const s=localStorage.getItem('mann_mitra');if(s){const d=JSON.parse(s);Object.assign(state,d);state.badges=new Set(d.badges||[]);state.conversationHistory=d.conversationHistory||[];state.theme=d.theme||'light';state.moodCalendar=d.moodCalendar||{};state.assessmentAnswers=d.assessmentAnswers||[];applyTheme(state.theme);if(state.user){if(state.assessmentAnswers.length<5){showAssessmentPage()}else{showMainApp()}}else{showLoginPage()}}else{showLoginPage()}updateUI()}function save(){localStorage.setItem('mann_mitra',JSON.stringify({...state,badges:Array.from(state.badges)}))}function toggleTheme(){state.theme=state.theme==='light'?'dark':'light';applyTheme(state.theme);save()}function applyTheme(theme){document.documentElement.setAttribute('data-theme',theme);document.getElementById('themeToggle').textContent=theme==='light'?'üåô':'‚òÄÔ∏è'}function showLoginPage(){document.getElementById('loginPage').classList.remove('hidden');document.getElementById('assessmentPage').classList.add('hidden');document.getElementById('mainApp').classList.add('hidden')}function showAssessmentPage(){document.getElementById('loginPage').classList.add('hidden');document.getElementById('assessmentPage').classList.remove('hidden');document.getElementById('mainApp').classList.add('hidden');renderQuestion()}function showMainApp(){document.getElementById('loginPage').classList.add('hidden');document.getElementById('assessmentPage').classList.add('hidden');document.getElementById('mainApp').classList.remove('hidden');updateGreeting();renderCalendar()}function handleLogin(e){e.preventDefault();const name=document.getElementById('userName').value.trim();const age=parseInt(document.getElementById('userAge').value);const email=document.getElementById('userEmail').value.trim();if(!name||age<13||age>100||!email.includes('@')){alert('Please fill all fields correctly');return}state.user={name,age,email,loginDate:new Date().toISOString()};save();showAssessmentPage()}function renderQuestion(){const index=state.currentQuestionIndex;document.getElementById('questionNum').textContent=index+1;document.getElementById('currentQuestion').textContent=index+1;document.getElementById('questionText').textContent=ASSESSMENT_QUESTIONS[index];const progress=(index+1)/5*100;document.getElementById('progressFill').style.width=progress+'%';document.getElementById('progressPercent').textContent=Math.round(progress);document.querySelectorAll('.option-btn').forEach(btn=>btn.classList.remove('selected'));if(state.assessmentAnswers[index]){const selectedBtn=document.querySelectorAll('.option-btn')[state.assessmentAnswers[index]-1];if(selectedBtn)selectedBtn.classList.add('selected');document.getElementById('nextBtn').disabled=false}else{document.getElementById('nextBtn').disabled=true}document.getElementById('prevBtn').disabled=index===0}function selectOption(value){state.assessmentAnswers[state.currentQuestionIndex]=value;document.querySelectorAll('.option-btn').forEach(btn=>btn.classList.remove('selected'));event.target.closest('.option-btn').classList.add('selected');document.getElementById('nextBtn').disabled=false;save()}function nextQuestion(){if(state.currentQuestionIndex<4){state.currentQuestionIndex++;renderQuestion()}else{completeAssessment()}}function previousQuestion(){if(state.currentQuestionIndex>0){state.currentQuestionIndex--;renderQuestion()}}function completeAssessment(){const total=state.assessmentAnswers.reduce((a,b)=>a+b,0);const avg=total/5;let stressLevel='Low';if(avg>=4)stressLevel='High';else if(avg>=3)stressLevel='Moderate';state.stressLevel=stressLevel;state.stressScore=avg.toFixed(1);save();showMainApp()}function handleLogout(){if(confirm('Are you sure you want to logout?')){state.user=null;state.assessmentAnswers=[];state.currentQuestionIndex=0;save();showLoginPage()}}function updateGreeting(){if(!state.user)return;const hour=new Date().getHours();let greeting,icon;if(hour>=5&&hour<12){greeting='Good Morning';icon='üåÖ'}else if(hour>=12&&hour<17){greeting='Good Afternoon';icon='‚òÄÔ∏è'}else if(hour>=17&&hour<21){greeting='Good Evening';icon='üåÜ'}else{greeting='Good Night';icon='üåô'}document.getElementById('greetingTime').textContent=greeting;document.getElementById('greetingIcon').textContent=icon;document.getElementById('greetingName').textContent=`${greeting}, ${state.user.name}! üëã`}function updateUI(){document.getElementById('streakCount').textContent=state.streak;document.getElementById('totalSessions').textContent=state.sessions;document.getElementById('resilienceScore').textContent=state.resilience;document.getElementById('goalsCompleted').textContent=state.goals;updateBadges();if(state.user)updateGreeting()}function updateBadges(){const map={'3day':3,'7day':7,'14day':14,'30day':30,'first':1,'10sessions':10};Object.entries(map).forEach(([badge,req])=>{const el=document.querySelector(`[data-badge="${badge}"]`);if(!el)return;const unlocked=(badge.includes('day')&&state.streak>=req)||(badge==='first'&&state.sessions>=1)||(badge==='10sessions'&&state.sessions>=10);if(unlocked){el.classList.remove('locked');el.classList.add('unlocked');state.badges.add(badge)}})}function saveMood(mood){const today=new Date().toISOString().split('T')[0];state.moodCalendar[today]=mood;save();renderCalendar()}function renderCalendar(){const grid=document.getElementById('calendarGrid');if(!grid)return;grid.innerHTML='';const monthNames=['January','February','March','April','May','June','July','August','September','October','November','December'];const dayNames=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];document.getElementById('calendarMonth').textContent=`${monthNames[state.currentMonth]} ${state.currentYear}`;dayNames.forEach(day=>{const header=document.createElement('div');header.className='calendar-day-header';header.textContent=day;grid.appendChild(header)});const firstDay=new Date(state.currentYear,state.currentMonth,1).getDay();const daysInMonth=new Date(state.currentYear,state.currentMonth+1,0).getDate();const today=new Date();const todayStr=today.toISOString().split('T')[0];for(let i=0;i<firstDay;i++){const empty=document.createElement('div');empty.className='calendar-day empty';grid.appendChild(empty)}for(let day=1;day<=daysInMonth;day++){const dateStr=`${state.currentYear}-${String(state.currentMonth+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;const dayEl=document.createElement('div');dayEl.className='calendar-day';if(dateStr===todayStr){dayEl.classList.add('today')}const dayNum=document.createElement('div');dayNum.className='calendar-day-number';dayNum.textContent=day;dayEl.appendChild(dayNum);if(state.moodCalendar[dateStr]){const moodEmoji=document.createElement('div');moodEmoji.className='calendar-day-mood';moodEmoji.textContent=MOOD_EMOJIS[state.moodCalendar[dateStr]];dayEl.appendChild(moodEmoji)}grid.appendChild(dayEl)}}function changeMonth(delta){state.currentMonth+=delta;if(state.currentMonth>11){state.currentMonth=0;state.currentYear++}else if(state.currentMonth<0){state.currentMonth=11;state.currentYear--}renderCalendar()}async function getDostResponse(userMessage){const lower=userMessage.toLowerCase();if(lower.includes('suicide')||lower.includes('kill myself')||lower.includes('end it')||lower.includes('‡§Æ‡§∞‡§®‡§æ')||lower.includes('‡§ñ‡•Å‡§¶‡§ï‡•Å‡§∂‡•Ä')||lower.includes('mar jaana')||lower.includes('harm myself')||lower.includes('khatam kar')){showCrisis();return'Main aapki help karna chahta hoon, lekin yeh ek serious situation hai. üíô\n\nKya aap kisi professional se baat karna chahenge? Main aapko kuch helpline numbers de sakta hoon:\n\nüÜò National Crisis Line: 988\nüÜò KIRAN: 1800-599-0019\nüÜò Vandrevala: 1860-266-2345\nüÜò iCall: 9152987821\n\nAap akele nahi hain. Professional help lena bahut important hai. Kya aap mujhe aur batana chahenge ki aap kaisa feel kar rahe hain?'}state.conversationHistory.push({role:'user',content:userMessage});try{const response=await fetch(GROK_API_URL,{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${GROK_API_KEY}`},body:JSON.stringify({model:'grok-beta',messages:[{role:'system',content:SYSTEM_PROMPT},...state.conversationHistory],temperature:0.8,max_tokens:500})});if(!response.ok){throw new Error('Grok API failed')}const data=await response.json();const dostMessage=data.choices[0].message.content;state.conversationHistory.push({role:'assistant',content:dostMessage});if(state.conversationHistory.length>30){state.conversationHistory=state.conversationHistory.slice(-30)}save();return dostMessage}catch(error){console.error('Grok API Error:',error);return getFallbackDostResponse(userMessage)}}function getFallbackDostResponse(text){const lower=text.toLowerCase();const responses={positive:['Wah! Yeh sunke bahut achha laga! üòä\n\nKya aap mujhe aur bata sakte hain ki aaj kya special hua? Main sunna chahta hoon!','Bahut badhiya! Mujhe khushi hui yeh sunke! üåü\n\nAapko aisa kaisa feel ho raha hai? Aur kuch share karna chahenge?'],negative:['Mujhe sunke dukh hua ki aapka din aisa tha. üíô\n\nMain samajh sakta hoon ki aap aisa feel kar rahe hain. Kya aap mujhe aur bata sakte hain iske baare mein? Main yahan hoon sunne ke liye.','Main aapke saath hoon. Yeh mushkil time hai.\n\nAapko aisa kyun lag raha hai? Kya kuch specific hua tha? Main sunna chahta hoon.'],neutral:['Main samajh sakta hoon.\n\nKya aap mujhe thoda aur detail mein bata sakte hain? Aapke mann mein kya chal raha hai?','Theek hai, main sun raha hoon.\n\nIsse aapko kaisa feel ho raha hai? Aur kuch hai jo aap share karna chahenge?'],followup:['Kya aap mujhe aur bata sakte hain iske baare mein?','Aapko aisa kyun lag raha hai?','Isse aapko kaisa feel ho raha hai?','Kya isse pehle bhi aapko aisa experience hua hai?','Is situation mein aapne kya kiya?','Main yahan hoon sunne ke liye. Aur kuch share karna chahenge?','Aapke mann mein aur kya chal raha hai?']};if(lower.includes('accha')||lower.includes('good')||lower.includes('badhiya')||lower.includes('mast')||lower.includes('great')||lower.includes('happy')||lower.includes('khush')){return responses.positive[Math.floor(Math.random()*responses.positive.length)]}else if(lower.includes('bura')||lower.includes('bad')||lower.includes('bekaar')||lower.includes('kharab')||lower.includes('sad')||lower.includes('dukhi')||lower.includes('pareshan')||lower.includes('stress')||lower.includes('tension')){return responses.negative[Math.floor(Math.random()*responses.negative.length)]}else if(lower.includes('theek')||lower.includes('okay')||lower.includes('normal')){return responses.neutral[Math.floor(Math.random()*responses.neutral.length)]}else{return responses.followup[Math.floor(Math.random()*responses.followup.length)]}}function addMessage(text,isUser=false){const container=document.getElementById('chatMessages');const div=document.createElement('div');div.className=`message ${isUser?'user-message':'ai-message'}`;if(!isUser){const avatar=document.createElement('div');avatar.className='message-avatar';avatar.textContent='ü§ó';div.appendChild(avatar)}const content=document.createElement('div');content.className='message-content';content.textContent=text;div.appendChild(content);container.appendChild(div);container.scrollTop=container.scrollHeight;state.history.push({text,isUser,time:Date.now()})}async function sendMessage(){const input=document.getElementById('messageInput');const text=input.value.trim();if(!text)return;addMessage(text,true);input.value='';input.style.height='50px';document.getElementById('typingIndicator').classList.remove('hidden');const dostResponse=await getDostResponse(text);document.getElementById('typingIndicator').classList.add('hidden');addMessage(dostResponse);save()}function startSession(){document.getElementById('home').style.display='none';document.getElementById('chatSection').classList.remove('hidden');state.history=[];state.conversationHistory=[];setTimeout(()=>addMessage('Kaisa tha aapka aaj ka din?'),500)}function endSession(){if(confirm('End this session?')){completeSession()}}function completeSession(){const today=new Date().toDateString();const last=state.lastDate;if(last){const yesterday=new Date();yesterday.setDate(yesterday.getDate()-1);if(last===yesterday.toDateString())state.streak++;else if(last!==today)state.streak=1}else state.streak=1;state.lastDate=today;state.sessions++;state.resilience=Math.min(100,state.resilience+5);save();updateUI();document.getElementById('modalStreak').textContent=state.streak;document.getElementById('completionModal').classList.remove('hidden')}function closeModal(){document.getElementById('completionModal').classList.add('hidden');document.getElementById('chatSection').classList.add('hidden');document.getElementById('home').style.display='block'}function quickMood(mood){saveMood(mood);if(mood==='struggling')showCrisis();startSession()}function toggleVoice(){const btn=document.getElementById('voiceBtn');if('webkitSpeechRecognition'in window){const r=new webkitSpeechRecognition();r.lang='hi-IN';r.continuous=false;btn.classList.add('listening');r.onresult=e=>{document.getElementById('messageInput').value=e.results[0][0].transcript;btn.classList.remove('listening')};r.onerror=()=>btn.classList.remove('listening');r.onend=()=>btn.classList.remove('listening');r.start()}else alert('Voice not supported. Use Chrome/Edge.')}function showCrisis(){document.getElementById('crisisBanner').classList.remove('hidden');window.scrollTo({top:0,behavior:'smooth'})}function closeCrisis(){document.getElementById('crisisBanner').classList.add('hidden')}function showSection(section){document.querySelectorAll('.hero,.calendar-section,.insights-section,.resources-section').forEach(s=>s.classList.add('hidden'));document.querySelectorAll('.nav-link').forEach(l=>l.classList.remove('active'));if(section==='home')document.querySelector('.hero').classList.remove('hidden');else if(section==='calendar'){document.getElementById('calendar').classList.remove('hidden');renderCalendar()}else if(section==='journal')document.getElementById('journal').classList.remove('hidden');else if(section==='resources')document.getElementById('resources').classList.remove('hidden');event.target.classList.add('active')}function startCBT(type){const modal=document.getElementById('cbtModal');const content=document.getElementById('cbtContent');modal.classList.remove('hidden');if(type==='breathing'){content.innerHTML=`<h2>üå¨Ô∏è Breathing Exercise</h2><p>Chalo deep breathing practice karte hain.</p><div class="breathing-circle inhale" id="breathCircle">Breathe In</div><p><strong>Circle ko follow karo:</strong></p><p>‚Ä¢ Breathe IN (4 sec) - Circle badhega</p><p>‚Ä¢ Hold (4 sec)</p><p>‚Ä¢ Breathe OUT (4 sec) - Circle chhota hoga</p><p>‚Ä¢ 5 minutes repeat karo</p><button class="btn-primary" onclick="closeCBTModal()">Complete</button>`;setTimeout(()=>{const circle=document.getElementById('breathCircle');let isInhale=true;setInterval(()=>{circle.textContent=isInhale?'Breathe In':'Breathe Out';circle.className=isInhale?'breathing-circle inhale':'breathing-circle exhale';isInhale=!isInhale},4000)},100)}else if(type==='reframing'){content.innerHTML=`<h2>üí≠ Thought Reframing</h2><p>Negative thoughts ko challenge karte hain.</p><p><strong>Negative thought:</strong></p><textarea class="thought-input" id="negThought" placeholder="e.g., Main kuch theek se nahi kar sakta..."></textarea><p><strong>Evidence against it:</strong></p><textarea class="thought-input" id="posThought" placeholder="e.g., Maine project complete kiya..."></textarea><p><strong>Dost ko kya kehte?</strong></p><textarea class="thought-input" id="friendThought" placeholder="Compassionate response..."></textarea><button class="btn-primary" onclick="saveReframing()">Save</button> <button class="btn-secondary" onclick="closeCBTModal()">Close</button>`}else if(type==='goals'){content.innerHTML=`<h2>üéØ Goal Setting</h2><p>Chhote goals set karte hain.</p><p><strong>Aaj ka goal:</strong></p><textarea class="thought-input" id="goalInput" placeholder="e.g., 10 min walk..."></textarea><button class="btn-primary" onclick="addGoal()">Add Goal</button><div id="goalsList" class="goal-list"></div><button class="btn-secondary" onclick="closeCBTModal()">Close</button>`}}function closeCBTModal(){document.getElementById('cbtModal').classList.add('hidden');state.goals++;save();updateUI()}function saveReframing(){const neg=document.getElementById('negThought').value;const pos=document.getElementById('posThought').value;const friend=document.getElementById('friendThought').value;if(neg&&pos&&friend){alert('Bahut badhiya! Thought reframe ho gaya.');closeCBTModal()}else alert('Please sab fields fill karo.')}function addGoal(){const input=document.getElementById('goalInput');const goal=input.value.trim();if(goal){const list=document.getElementById('goalsList');const item=document.createElement('div');item.className='goal-item';item.innerHTML=`<span>${goal}</span><button class="btn-small" onclick="completeGoal(this)">‚úì</button>`;list.appendChild(item);input.value=''}else alert('Goal enter karo.')}function completeGoal(btn){btn.parentElement.classList.add('completed');state.goals++;save();updateUI();setTimeout(()=>btn.parentElement.remove(),2000)}load();document.getElementById('messageInput')?.addEventListener('keypress',e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendMessage()}});document.getElementById('messageInput')?.addEventListener('input',function(){this.style.height='50px';this.style.height=(this.scrollHeight)+'px'});
  </script>
</body>
</html>